==8163== NVPROF is profiling process 8163, command: ./a.out
==8163== Warning: Unified Memory Profiling is not supported on the underlying platform. System requirements for unified memory can be found at: http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#um-requirements
==8163== Profiling application: ./a.out
==8163== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   63.89%  1.14750s       500  2.2950ms  1.6430ms  3.2850ms  naive_generation(int*, int*, unsigned int*)
                   11.29%  202.81ms      1000  202.81us  183.08us  338.08us  swap_with_positions(int*, int*, int*, int, int)
                    9.39%  168.63ms       500  337.25us  303.81us  778.51us  evaluate_kernel(int*, int, float const *, float*, int*)
                    6.45%  115.91ms         1  115.91ms  115.91ms  115.91ms  generate_seed_pseudo(__int64, __int64, __int64, curandOrdering, curandStateXORWOW*, unsigned int*)
                    2.40%  43.138ms      1001  43.095us  22.033us  163.13us  void gen_sequenced<curandStateXORWOW, unsigned int, int, __operator_&__(unsigned int curand_noargs<curandStateXORWOW>(curandStateXORWOW*, int)), rng_config<curandStateXORWOW>>(curandStateXORWOW*, unsigned int*, unsigned long, unsigned long, int)
                    1.06%  18.981ms      2000  9.4900us  3.5420us  24.636us  void thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int, int>(thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int, int>*, bool=0 const *, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int, int>**, bool=0*, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int, int>**, int, int, thrust::cuda_cub::cub::GridEvenShare<thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int, int>**>)
                    0.93%  16.702ms         1  16.702ms  16.702ms  16.702ms  init_pop_s(int*, int, int, unsigned int*)
                    0.90%  16.093ms      1500  10.728us  7.3960us  24.271us  void thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int, int>(thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int, int>*, bool=1 const *, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int, int>**, bool=0*, thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int, int>**, int, int, thrust::cuda_cub::cub::GridEvenShare<thrust::cuda_cub::cub::DeviceRadixSortDownsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int, int>**>)
                    0.87%  15.596ms      3500  4.4560us  4.0100us  10.520us  void thrust::cuda_cub::cub::RadixSortScanBinsKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, int>(int*, int)
                    0.80%  14.357ms       500  28.714us  26.147us  47.032us  [CUDA memcpy DtoD]
                    0.71%  12.663ms       500  25.325us  24.323us  44.220us  void thrust::cuda_cub::cub::DeviceRadixSortSingleTileKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<unsigned int, int, int>::Policy700, bool=0, unsigned int, int, int>(int const *, thrust::cuda_cub::cub::DeviceRadixSortSingleTileKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<unsigned int, int, int>::Policy700, bool=0, unsigned int, int, int>*, thrust::cuda_cub::cub::DeviceRadixSortPolicy<unsigned int, int, int>::Policy700 const *, thrust::cuda_cub::cub::DeviceRadixSortSingleTileKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<unsigned int, int, int>::Policy700, bool=0, unsigned int, int, int>**, bool=0, int, int)
                    0.60%  10.789ms      2000  5.3940us  4.3750us  11.667us  void thrust::cuda_cub::cub::DeviceRadixSortUpsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=0, bool=0, float, int>(thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, bool=0*, thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, int, int, thrust::cuda_cub::cub::GridEvenShare<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *>)
                    0.39%  6.9333ms      1500  4.6220us  3.2290us  11.511us  void thrust::cuda_cub::cub::DeviceRadixSortUpsweepKernel<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700, bool=1, bool=0, float, int>(thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, bool=1*, thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *, int, int, thrust::cuda_cub::cub::GridEvenShare<thrust::cuda_cub::cub::DeviceRadixSortPolicy<float, int, int>::Policy700 const *>)
                    0.12%  2.1037ms      1000  2.1030us  1.3020us  6.1980us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<int*, int*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<int>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<int*, int*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<int>, thrust::cuda_cub::__transform::always_true_predicate>, long>(int*, thrust::cuda_cub::__transform::no_stencil_tag)
                    0.07%  1.1970ms       500  2.3930us  1.8750us  4.5830us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<float*, float*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<float>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<float*, float*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<float>, thrust::cuda_cub::__transform::always_true_predicate>, long>(float*, thrust::cuda_cub::__transform::no_stencil_tag)
                    0.07%  1.1927ms       500  2.3850us  1.8750us  4.6880us  swap_best(int*, float*, int, int*, float*)
                    0.06%  1.0672ms       500  2.1340us  1.7190us  3.3340us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<unsigned int*, unsigned int*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<unsigned int>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<unsigned int*, unsigned int*, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<unsigned int>, thrust::cuda_cub::__transform::always_true_predicate>, long>(unsigned int*, thrust::cuda_cub::__transform::no_stencil_tag)
                    0.02%  281.84us       503     560ns     468ns  2.6040us  [CUDA memcpy DtoH]
                    0.00%  9.8950us         2  4.9470us  1.1450us  8.7500us  [CUDA memcpy HtoD]
      API calls:   66.36%  4.83663s      1012  4.7793ms  10.885us  4.78265s  cudaMalloc
                   13.51%  984.86ms      2001  492.18us  6.8230us  17.033ms  cudaDeviceSynchronize
                   10.63%  775.09ms     16503  46.966us  27.500us  1.1396ms  cudaLaunchKernel
                    3.40%  247.51ms      1014  244.09us  1.8750us  118.30ms  cudaFree
                    2.33%  169.69ms         1  169.69ms  169.69ms  169.69ms  cudaDeviceReset
                    2.03%  148.02ms      1005  147.28us  47.448us  834.32us  cudaMemcpy
                    0.71%  51.583ms      4000  12.895us  8.3330us  153.23us  cudaFuncGetAttributes
                    0.33%  24.177ms       503  48.065us  31.250us  160.26us  cudaGetDeviceProperties
                    0.27%  19.388ms      6000  3.2310us  1.5630us  994.06us  cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags
                    0.19%  13.557ms     15000     903ns     520ns  82.552us  cudaPeekAtLastError
                    0.09%  6.7341ms      3000  2.2440us  1.3020us  174.22us  cudaDeviceGetAttribute
                    0.09%  6.7162ms      3001  2.2370us  1.4060us  61.823us  cudaGetDevice
                    0.06%  4.1657ms      4004  1.0400us     520ns  44.636us  cudaGetLastError
                    0.00%  224.22us       191  1.1730us     572ns  33.698us  cuDeviceGetAttribute
                    0.00%  158.02us         1  158.02us  158.02us  158.02us  cudaEventSynchronize
                    0.00%  88.178us         2  44.089us  32.188us  55.990us  cudaEventRecord
                    0.00%  36.093us         1  36.093us  36.093us  36.093us  cudaThreadSynchronize
                    0.00%  24.792us         2  12.396us  5.0520us  19.740us  cudaEventCreate
                    0.00%  18.281us         2  9.1400us  8.0730us  10.208us  cuDeviceTotalMem
                    0.00%  9.2700us         2  4.6350us  2.6040us  6.6660us  cudaEventDestroy
                    0.00%  6.9270us         4  1.7310us  1.2500us  2.5000us  cuDeviceGetCount
                    0.00%  6.9270us         1  6.9270us  6.9270us  6.9270us  cudaEventElapsedTime
                    0.00%  4.7910us         1  4.7910us  4.7910us  4.7910us  cuInit
                    0.00%  4.1670us         3  1.3890us  1.1460us  1.8750us  cuDeviceGet
                    0.00%  3.5420us         2  1.7710us  1.7190us  1.8230us  cuDeviceGetName
                    0.00%  2.0310us         2  1.0150us     885ns  1.1460us  cuDeviceGetUuid
                    0.00%  1.9790us         1  1.9790us  1.9790us  1.9790us  cuDriverGetVersion
